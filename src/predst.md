# Представление чисел в разрядной сетке в ВМ

Количество двоичных разрядов выделяемых для хранения данного
называют разрядной сеткой

![](./5.png) 

1. Разрядная сетка для определённая типа данных имеет фиксированный 
   размер состоящий n-разрядов.
2. Размер разрядной сетки программы задаётся на этапе
   объявления переменных и зависит от типа данных.
3. Обязательным требованием любой системы программирования 
   является одинаковость типов в операндах выражения,
   а следовательноть и одинаковость рамера данных, 
   то есть разрядной сетки
4. Так как для двоичной системы счисления алфавит: 0 и 1,
   может представить только целое число без знака.
   
## Представление целых чисел со знаком

Для указания знака разрядная сетка разбивается на два 
поля:

- Старший разряд - выделяется для хранения знака числа (знаковый 
  разряд):
  - 0 - положительное
  - 1 - отрицательное 
- Остальные разряды хранят значащую часть числа


## Вещественные числа 

### Числа с фиксированной точкой 

1. Целые число -- как действительное у которого отсутствует 
   дробная часть 
2. Целая часть числа равна 0, то число правильная дробь

Число с фиксированной точкой представляется следующим образом:

$$ x = X K_m $$

$x$ -- машинное преставление числа с фиксированной точкой

$X$ -- исходное число

$K_m$ -- масштабный коэффициент, который выбирается 
из условий конкретной разрядной сетки и не должен допускать
выхода исходных чисел и результатов вычислений за пределы допустимого
диапазона.


### Числа с плавающей точкой 

Научная запись числа 

$$ X = M \cdot E^p $$


где:
- E = q -- основание системы счисления
- P -- порядок числа 
- M -- мантисса числа

Запись числа в научной форме допускает различные варианты,
поэтому для совместимости различного ПО и оборудования:

Представление чисел в формате с плавающей точккой было 
стандартизовано и указано в стандарте IEEE 754

Три основных формата представления двоичных чисел:

- число одинарной точности (`float`)
- число двойной точности (`double`)
- Расширенный формат (`long double` в языке C++) 

Для хранения числа в формате с плавающей точкой разбивается
на три поля:

- знак числа (1 бит)
- n_p разрядов  для хранение порядка
- оставшиеся n_m разрядов хранят мантиссу

Мантисса хранится в нормализованном виде:

1 <= M_n <= E

для двоичного числа:

1 <= M_n <= 2_10

Нормализованная мантисса двоичного числа в целой части всегда равна в 1.

Целая часть не хранится а подразумевается в алгоритмах 
или в аппаратных уровнях.

В поле мантиссы разрядной сетки хранится модуль обратной части числа.

Правило нормализации мантиссы:

Для двоичного числа точку разделяющую целую и дробную части
необходимо сдвигать влево или вправо до тех пор 
пока не будет получена целая часть числа равная 1.

При этом на каждом шаге сдвига порядок увеличивается при
сдвиге вправо или уменьшается при сдвиге влево.

### Порядок


- Стандарт IEEE 754 требует, чтобы в поле порядка 
  всегда указывалось только целое число без знака
- В поле порядка хранится смещенный на (2^{n_{p} - 1} - 1). 
  Порядок P_{cm} называется *характеристикой*
  


$P_{cm} = P + (2^{n_p - 1} - 1)$

- Характеристика всегда целое число без знака


## Алгоритм преобразования вещественного десятичного числа в формат с плавующей точкой


1. Представить целую часть вещественного числа в двоичном виде и поставить после нее десятичную точку.

2. Преобразовать дробную часть вещественного числа в двоичную систему счисления с точностью n_m, после точки.
3. Записать полученное значение в двоичной форме.
4. Нормализовать полученное двоичное число, определив значение показателя степени в порядке Р.
5. Найти характеристику Р_см = P+(2^n_p - 1).
6. Записать значение характеристики в соответствующие биты формата.
7. Записать дробную часть нормализованной мантиссы в поле мантиссы, отбросив разряды, выходящие за пределы этого поля.

**Примечание.**
Правила округления мантиссы могут отличаться в различных системах программирования.


8. Если число положительное, то в самый старший разряд представления следует записать  , если отрицательное - то 1.


## Числа в прямом и дополнительных кодах

Для сложения двух чисел по правилам алгебры необходимо выполнять дополнительные дествия:

1. Определение и сравнение знаков операндов
2. Сравнение модулей чисел организация разветвлённой структуры алгоритма, что приводит к перерасходу времени
   выполнения операции


Прямой код (принятый в алгебре) используется для представления мантиссы в 
числах с плавающей точкой.

### Достоинства

1. Простое получение кода отрицательных чисел
2. Значащая часть числа является его модулем
3. При заданной разрядной сетке количество положительных чисел равно отрицательным

### Недостатки 

1. Выполнение арифметических операций требует раздельной обработки значащей части числа 
   и знака, для которого не определены арифметические операции. Это требует усложнения 
   алгоритмов вычисления либо изменений в архитектуре процессора.

2. Число 0 имеет два значения - "+0" и "-0"


### Дополнительный код 

A - B = A + (-B) = A + (q^n - B) - q^n = A + B_д - q^n

A - B = A + B_д

Особенности:

- представление положительных чисел в прямом и дополнительном коде
- знаковый разряд может рассматриваться как число и, соответственно, 
  его можно использовать в вычислениях вместе с разрядами значащей части числа;
- Наиболее простой и быстрый алгоритм выполнения сложения чисел со знаком
- Чтобы изменить знак числа, записанного в дополнительном коде, достаточно 
  взять дополнение;
- Наличие только одного нуля;
- Представление не симметрично -- число отрицательных чисел 


